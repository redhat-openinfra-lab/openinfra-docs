
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ODF/">
      
      
        <link rel="next" href="../monitoring/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Backup Restore - Openinfrastructure Lab</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#backup-restore" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Openinfrastructure Lab" class="md-header__button md-logo" aria-label="Openinfrastructure Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Openinfrastructure Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Backup Restore
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="pink"  aria-label="Go to the dark side"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Go to the dark side" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="pink"  aria-label="Light side"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light side" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Openinfrastructure Lab" class="md-nav__button md-logo" aria-label="Openinfrastructure Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Openinfrastructure Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to the Red Hat NA-SSA Lab's Documentation Site.
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MiscellaneousNotes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous Notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../slideDeckLinks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presentation Links
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Ceph
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Ceph
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephAuthorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephCrushMap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRUSH Map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CephFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephInstallation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation Instructions v5.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephLogging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephNetworking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephOSD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSDs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephRGW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RADOS Gateway (RGW)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephRHELUpgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RHEL9 Upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephRados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RADOS Block Devices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephSizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sizing Guidelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/CephTuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance Tuning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/Cephv6installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation Instructions v6.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/dataservices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Services SSAs - Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ceph/encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    How To
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            How To
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certificates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/DNSServer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/DocumentationContribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation Contribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/ansiblesync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible Tower
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/jirachangerequest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab Change Requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Proof Of Concept Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Proof Of Concept Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_1" >
        
          
          <label class="md-nav__link" for="__nav_5_6_1" id="__nav_5_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Openshift
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_1">
            <span class="md-nav__icon md-icon"></span>
            Openshift
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/AffinityRules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Affinity / Anti-Affinity Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/AzureAD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrate with Azure AD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/CPUManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure CPU Pinning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/DedicatedLiveMigration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Dedicated Live Migration Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/Logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/NMState/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install NMState Operator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/activedirectory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrate with LDAP/AD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/imageregistry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Registry and VDDK Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/mustgather/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The must-gather Tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../How%20To/Proof%20Of%20Concept%20Topics/Openshift/secondaryScheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secondary Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    OCPv
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OCPv
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/highAvailability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes HA for VMs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/livemigrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Live Migrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/lvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lvm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/mtv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration Toolkit for Virtualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VM Snapshots and Clones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage for VMs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OCPv/templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ODF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ODF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ODF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Foundation Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Backup Restore
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Backup Restore
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#oadp" class="md-nav__link">
    <span class="md-ellipsis">
      OADP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#velero-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Velero CLI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-oadp-dpa" class="md-nav__link">
    <span class="md-ellipsis">
      Configure OADP DPA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-application-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Backup Application Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-of-stateful-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Backup of Stateful Applications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-specialized-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Using Specialized Tool
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multipath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multipath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rbac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quotas and Permisstions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal Registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snapshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snapshots and Clones
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Openshift
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Openshift
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/Containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/OCPBaremetalPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCP Baremetal IPI Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/cloudinstallation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS OCP 4 Cloud Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/disasterrecovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disasterrecovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/hcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCP Hosted Control Plane
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/ocpCertificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCP Certificates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openshift/ocpGeneral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCP General Info
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Openstack
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Openstack
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Openstack/OSP16.2Instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSP 16.2 Installation Instructions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="backup-restore">Backup Restore</h1>
<h2 id="oadp">OADP</h2>
<p>Features:</p>
<ul>
<li>Backup - all applications and can filter the resources by type, namespace, or label.  Kubernetes objects and internal images are saved as an archive to object storage.  PVs are backed up by creating a snapshot with the CSI or cloud-native snapshot API.</li>
<li>Restore - All objects in a backup can be restored or filter the objects by namespace, PV or label.</li>
<li>Schedule - Can schedule backups at specified intervals.</li>
<li>Hooks - can be used both pre and post backup or restore.  Restore hooks can run in an init container or in the application container.</li>
</ul>
<p>Data Mover is now fully supported for both containerized and VM workloads.  This allows you to move CSI volume snapshots to remote object stores.  It uses Kopia as the uploader mechanism to read the snapshot data and to write to the Unified Repository.</p>
<p>File system backup supports both the Restic and Kopia libraries.  This is specified during the installation through the uploader-type flag (restic/kopia and defaults to kopia).  This cannot be changed after installation.</p>
<p>Supported S3 compatible object storage providers:</p>
<ul>
<li>MinIO</li>
<li>MCG</li>
<li>AWS S3</li>
<li>IBM Cloud S3</li>
</ul>
<p>Supported object storage providers with their own plugins:</p>
<ul>
<li>GCP</li>
<li>Azure</li>
</ul>
<h2 id="velero-cli">Velero CLI</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>alias velero=&#39;oc -n openshift-adp exec deployment/velero -c velero -it -- ./velero&#39;
</code></pre></div>
<h2 id="configure-oadp-dpa">Configure OADP DPA</h2>
<p>Create OBC in the <code>openshift-adp</code> or <code>default</code> namespace.</p>
<p>Get the access/secret keys, bucket name, and bucket hostname/url
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>oc get configmap oadp-bucket -n openshift-adp -o jsonpath=&#39;{.data.BUCKET_NAME}{&quot;\n&quot;}&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>oc get configmap oadp-bucket -n openshift-adp -o jsonpath=&#39;{.data.BUCKET_HOST}{&quot;\n&quot;}&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>oc get secret oadp-bucket -n openshift-adp -o jsonpath=&#39;{.data.AWS_ACCESS_KEY_ID}{&quot;\n&quot;}&#39; | base64 -d
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>oc get secret oadp-bucket -n openshift-adp -o jsonpath=&#39;{.data.AWS_SECRET_ACCESS_KEY}{&quot;\n&quot;}&#39; | base64 -d
</code></pre></div></p>
<p>Install the OADP Operator; accept the default values.  </p>
<p>Create the <code>cloud credentials</code> secret in the openshift-adp namespace.</p>
<p>Create the Data Protection Application in the OADP Operator</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>kind: DataProtectionApplication  
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>apiVersion: oadp.openshift.io/v1alpha1
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>metadata:
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>  name: backup-odf
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>  namespace: openshift-adp
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>spec:
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>  backupLocations:
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    - velero:
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        config:
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="hll">          insecureSkipTLSVerify: &#39;true&#39;
</span><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>          profile: default
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="hll">          region: local
</span><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="hll">          s3ForcePathStyle: &#39;true&#39;
</span><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="hll">          s3Url: https://s3-openshift-storage.apps.blm-ocp.hexo.lab
</span><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>        credential:
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>          key: cloud
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>          name: cloud-credentials
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>        default: true
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        objectStorage:
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="hll">          bucket: oadp-bucket-b4991e9c-99fa-48f1-ba12-aaf6940277f4
</span><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>          prefix: oadp-backups
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>        provider: aws
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>  configuration:
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="hll">    nodeAgent:
</span><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="hll">      enable: true
</span><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="hll">      uploaderType: kopia
</span><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="hll">    velero:
</span><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="hll">      featureFlags: 
</span><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="hll">        - EnableCSI
</span><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="hll">      podConfig:
</span><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="hll">        resourceAllocations:
</span><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="hll">          limits:
</span><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="hll">            cpu: &quot;1&quot;
</span><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="hll">            memory: 1024Mi
</span><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="hll">          requests:
</span><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="hll">            cpu: 200m
</span><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="hll">            memory: 256Mi
</span><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>      defaultPlugins:
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>        - openshift
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>        - aws
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>        - kubevirt
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="hll">        - csi
</span><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>      resourceTimeout: 10m
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>  snapshotLocations:
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>    - velero:
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>        config:
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>          profile: default
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>          region: local
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>        provider: aws
</code></pre></div>
<p>Update the VolumeSnapShotClasses ocs-storagecluster-rbdplugin-snapclass; change the deletionPolicy to <code>Retain</code> and add the <code>label</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>apiVersion: snapshot.storage.k8s.io/v1
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="hll">deletionPolicy: Retain
</span><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>driver: openshift-storage.rbd.csi.ceph.com
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>kind: VolumeSnapshotClass
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>metadata:
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>  creationTimestamp: &#39;2024-05-09T16:22:18Z&#39;
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>  generation: 1
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="hll">  labels:
</span><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="hll">    velero.io/csi-volumesnapshot-class: &#39;true&#39;  
</span><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>  managedFields:
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>...
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>parameters:
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>  clusterID: openshift-storage
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>  csi.storage.k8s.io/snapshotter-secret-name: rook-csi-rbd-provisioner
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>  csi.storage.k8s.io/snapshotter-secret-namespace: openshift-storage
</code></pre></div>
<h2 id="backup-application-resources">Backup Application Resources</h2>
<p>Backup of the application resource for stateless applications:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>oc get deployment/example -o json | jq &#39;. | del(
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    .metadata.uid,
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    .metadata.selfLink,
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    .metadata.generation,
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    .metadata.resourceVersion,
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    .metadata.creationTimestamp,
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    .metadata.managedFields,
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    .metadata.annotations.&quot;deployment.kubernetes.io/revision&quot;,
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    .metadata.annotations.&quot;kubectl.kubernetes.io/last-applied-configuration&quot;,
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    .status
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>)&#39; &gt; deployment-backup.json
</code></pre></div></p>
<h2 id="backup-of-stateful-applications">Backup of Stateful Applications</h2>
<p>Requirements:  </p>
<ul>
<li>Application must be stopped to backup the data  </li>
<li>Application has a specialized backup tool (i.e. mysqldump)  </li>
</ul>
<p>Scale the application to zero replicas if app cannot be paused
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>oc scale deployment/myApp --replicas=0
</code></pre></div></p>
<p>Create a job to mounts the persistent volume and copies the data to a backup location
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>---
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>apiVersion: batch/v1
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>kind: Job
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>metadata:
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>  name: backup
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>  namespace: application
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>  labels:
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>    app: backup
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>spec:
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>  backoffLimit: 1
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>  template:
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    metadata:
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>      labels:
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>        app: backup
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>    spec:
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>      containers:
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>      - name: backup
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>        image: registry.access.redhat.com/ubi8/ubi:8.4-209
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="hll">        command: 
</span><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="hll">        - /bin/bash
</span><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="hll">        - -vc
</span><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="hll">        - &#39;dnf -qy install rsync &amp;&amp; rsync -avH /var/application /opt/backup&#39;
</span><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>        resources: {}
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="hll">        volumeMounts: 
</span><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="hll">        - name: application-data
</span><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="hll">          mountPath: /var/application
</span><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="hll">        - name: backup
</span><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="hll">          mountPath: /opt/backup
</span><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="hll">      volumes: 
</span><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="hll">      - name: application-data
</span><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="hll">        persistentVolumeClaim:
</span><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="hll">          claimName: pvc-application
</span><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="hll">      - name: backup
</span><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="hll">        persistentVolumeClaim:
</span><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="hll">          claimName: pvc-backup
</span><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>      restartPolicy: Never
</code></pre></div></p>
<blockquote>
<p>NOTE: The command section is used to install and execute rsync.  The volumeMounts section mounts both the original PVC and the PVC to hold the copy of the data.  The volume section references the PVC names.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>oc apply -f backup-job.yaml
</code></pre></div>
<p>Scale the application back to original state when complete
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>oc scale deployment/myApp --replicas=1 
</code></pre></div></p>
<h2 id="using-specialized-tool">Using Specialized Tool</h2>
<p>Example using MYSQL
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>oc exec -it deployment/mariadb -- /bin/bash
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>...
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>$ mysql -u ${MYSQL_USER} -p &quot;${MYSQL_PASSWORD}&quot; ${MYSQL_DATABASE}
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>...
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>MariaDB [example]&gt; FLUSH TABLES WITH READ LOCK ;
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>...
</code></pre></div></p>
<p>Create a job to dump the database to another PVC:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>---
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>apiVersion: batch/v1
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>kind: Job
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>metadata:
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>  name: mariadb-backup
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>  namespace: application
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>  labels:
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    app: mariadb-backup
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>spec:
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>  backoffLimit: 1
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>  template:
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    metadata:
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>      labels:
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>        app: mariadb-backup
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>    spec:
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>      containers:
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>      - name: mariadb-backup
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>        image: mariadb:10.5
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>        workingDir: /opt/backup
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="hll">        command: 
</span><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="hll">        - /bin/bash
</span><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="hll">        - -vc
</span><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="hll">        - &#39;mysqldump -v -h &quot;${MYSQL_HOST}&quot; -P &quot;${MYSQL_PORT}&quot; -u &quot;root&quot; -p&quot;${MYSQL_ROOT_PASSWORD}&quot; --databases &quot;${MYSQL_DATABASE}&quot; &gt; backup.sql&#39;
</span><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>        resources: {}
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="hll">        env: 
</span><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="hll">        - name: MYSQL_HOST
</span><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="hll">          value: mariadb.application
</span><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="hll">        - name: MYSQL_PORT
</span><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="hll">          value: &quot;3306&quot;
</span><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="hll">        envFrom: 
</span><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="hll">        - configMapRef:
</span><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="hll">            name: mariadb
</span><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="hll">        - secretRef:
</span><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="hll">            name: mariadb
</span><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="hll">        volumeMounts: 
</span><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="hll">        - name: backup
</span><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="hll">          mountPath: /opt/backup
</span><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="hll">      volumes:  
</span><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="hll">      - name: backup
</span><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="hll">        persistentVolumeClaim:
</span><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="hll">          claimName: pvc-backup
</span><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a>      restartPolicy: Never
</code></pre></div></p>
<blockquote>
<p>NOTE: Command section is used to run the mysqldump.  The env section is used to pass the <code>mariadb</code> service information.  The envFrom is used to pass the database name and credentials.  The volumeMounts indicate where to mount the backup PVC and the volumes section references the PVC to use.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>oc apply -f backup-job.yaml
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Red Hat NA-SSA Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.instance", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>